<!DOCTYPE html>
<html lang="en">
<head>
    <title>Playfair Cipher</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/css/bootstrap.min.css" rel="stylesheet"/>
    <style>
        table.matrix-table {
            border-collapse: collapse;
            margin: 20px auto;
        }
        table.matrix-table td {
            border: 1px solid black;
            width: 30px;
            height: 30px;
            text-align: center;
            vertical-align: middle;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <table class="table">
            <tr>
                <td style="text-align: center; font-weight: bold; font-size: 25px;">PLAYFAIR CIPHER</td>
            </tr>
            <tr>
                <td style="font-weight: bold; color: blue">CREATE MATRIX</td>
            </tr>
            <tr>
                <td>
                    <div class="mb-3">
                        <label class="form-label">Key for Matrix:</label>
                        <input type="text" class="form-control" id="matrixKey" placeholder="Input Key" required>
                    </div>
                    <button type="button" class="btn btn-secondary" onclick="createMatrix()">Create Matrix</button>
                    <div id="matrixDisplay" class="mt-3"></div>
                </td>
            </tr>
            <tr>
                <td style="font-weight: bold; color: blue">ENCRYPTION</td>
            </tr>
            <tr>
                <td>
                    <form id="encryptForm" onsubmit="handleSubmit(event, 'encrypt')">
                        <div class="mb-3">
                            <label class="form-label">Plain text:</label>
                            <input type="text" class="form-control" name="plain_text" placeholder="Input Plain Text" required autofocus>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Key:</label>
                            <input type="text" class="form-control" name="key" placeholder="Input Key" required>
                        </div>
                        <button type="submit" class="btn btn-primary">Encrypt</button>
                    </form>
                </td>
            </tr>
            <tr>
                <td style="font-weight: bold; color: blue">DECRYPTION</td>
            </tr>
            <tr>
                <td>
                    <form id="decryptForm" onsubmit="handleSubmit(event, 'decrypt')">
                        <div class="mb-3">
                            <label class="form-label">Cipher text:</label>
                            <input type="text" class="form-control" name="cipher_text" placeholder="Input Cipher Text" required/>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Key:</label>
                            <input type="text" class="form-control" name="key" placeholder="Input Key" required/>
                        </div>
                        <button type="submit" class="btn btn-success">Decrypt</button>
                    </form>
                </td>
            </tr>
        </table>
    </div>

    <script>
        async function handleSubmit(event, type) {
            event.preventDefault();
            const form = event.target;
            const formData = new FormData(form);
            const data = {};
            formData.forEach((value, key) => {
                data[key] = value;
            });

            try {
                const response = await fetch(`http://localhost:5050/api/playfair/${type}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(data)
                });

                const result = await response.json();
                if (result.error) {
                    alert(result.error);
                } else {
                    alert(type === 'encrypt' ? `Encrypted text: ${result.cipher_text}` : `Decrypted text: ${result.plain_text}`);
                }
            } catch (error) {
                alert('Error: ' + error.message);
            }
        }

        async function createMatrix() {
            const keyInput = document.getElementById('matrixKey');
            const key = keyInput.value;
            const matrixDisplay = document.getElementById('matrixDisplay');

            if (!key) {
                alert('Please enter a key to create the matrix.');
                return;
            }

            try {
                const response = await fetch('http://localhost:5050/api/playfair/create_matrix', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({ key: key })
                });

                const result = await response.json();

                if (result.error) {
                    matrixDisplay.innerHTML = `<p style="color: red;">${result.error}</p>`;
                } else if (result.matrix) {
                    let matrixHTML = '<table class="matrix-table"><tbody>';
                    result.matrix.forEach(row => {
                        matrixHTML += '<tr>';
                        row.forEach(cell => {
                            matrixHTML += `<td>${cell}</td>`;
                        });
                        matrixHTML += '</tr>';
                    });
                    matrixHTML += '</tbody></table>';
                    matrixDisplay.innerHTML = matrixHTML;
                } else {
                    matrixDisplay.innerHTML = '<p>Unexpected response from server.</p>';
                }

            } catch (error) {
                matrixDisplay.innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
            }
        }
    </script>
</body>
</html> 